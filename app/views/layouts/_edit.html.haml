- param_name, human_name = object.class.param_name, object.class.human_name
- if object.id
  - path = url_for(controller: object.class.param_name.pluralize, action: 'update', id: object.id, only_path: true)
  - method, title, modal_id = :put, "Edit #{human_name}", object.id
- else
  - path = url_for(controller: object.class.param_name.pluralize, action: 'create', only_path: true)
  - method, title, modal_id = :post, "New #{human_name}", 'new'
-# generate form templates for associations
- if edit_mode
  - object.class.reflect_on_all_associations.each do |association|
    = render partial: 'layouts/association_form_template', locals: {association: association, object: object, primary_key: primary_key}
-# in modal editor
.modal.hide.fade.m_patient_editor{id: modal_id}
  = form_tag(path, method: method, class: 'form-horizontal') do
    .modal-header
      %a.close{data: {dismiss: 'modal'}}
        Ã—
      %h3= title
    .modal-body
      .container-fluid
        %fieldset
          %legend= human_name
          - object.form_details.each do |key, label, type, value|
            = render partial: 'layouts/attribute_form_element', locals: {key: key, label: label, type: type, value: value, param: param_name}
          - # render association details
          - object.class.reflect_on_all_associations.each do |association|
            = render partial: 'layouts/association_form', locals: {association: association, object: object}
      .scroll-helper
    .modal-footer
      %a.btn{href: '#', data: {dismiss: 'modal'}}
        Cancel
      %button.btn.btn-primary{type: 'submit', data: {'loading-text' => 'Working'}}
        Submit